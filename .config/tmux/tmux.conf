####################
#     MAIN_CONF    #
####################
# Status
set -g status-interval 1
set -g escape-time 2
set -g repeat-time 350
set -g display-time 1500

# Clors
set -g default-terminal "tmux-256color"

# set image support
set -gq allow-passthrough all
set -g visual-activity on

# Enable mouse mode
set -g mouse on

# set foncus events on for nvim
set -g focus-events on

# Enable clipboard
set -g set-clipboard on

# Set vi
set -g mode-keys vi

# automatic rename and renumber
set -g automatic-rename on
set -g renumber-windows on

# Windows index start from 1
set -g base-index 1
set -g pane-base-index 1

# Configure Tmux
set -g status-position top
set -g status-style "bg=#{@thm_mantle}"
set -g status-justify "left"

# pane border look and feel
setw -g pane-border-status off
setw -g pane-border-format ""
setw -g pane-active-border-style "fg=#{@thm_peach},bg=default"
setw -g pane-border-style "fg=#{@thm_overlay_2},bg=default"
setw -g pane-border-lines single

# window status format
set -gF window-status-separator "#[fg=#{@thm_surface_2}]"
set -g window-status-format " $default_window_terminal$default_window_number$default_window_name $default_window_panes$default_window_flags "
set -g window-status-style "bg=default"

# window status current format
set -g window-status-current-format " $current_window_terminal$current_window_number$current_window_name $current_window_panes$current_window_flags "
set -g window-status-current-style "bg=#{@thm_bg},bold" 

##################
#    KEYBINDS    #
##################

# Unbindings
unbind r
unbind p
unbind n
unbind c-b

# Open command key with Ctrl+A
set -g prefix c-a
set -g mouse on

# Fast reload
bind r source-file ~/.config/tmux/tmux.conf \; display-message "Config reloaded!"

# new window
bind c-n new-window

# Overview
bind w choose-tree -Z

# Windows navigation
bind -n M-9 switch-client -p
bind -n M-0 switch-client -n

# Moving around each panel
#   i      ↑
# j k l  ← ↓ →
bind-key i select-pane -L
bind-key o select-pane -U
bind-key k select-pane -D
bind-key l select-pane -R

#################
#    PLUGINS    #
#################
# Auto-install TPM if not present
if "test ! -d ~/.tmux/plugins/tpm" \
   "run 'git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm && ~/.tmux/plugins/tpm/bin/install_plugins'"

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-cpu'
set -g @plugin 'catppuccin/tmux'

################
#    BLOCKS    #
################

# Configure Cpu
set -g @cpu_percentage_format "%03d%%"
set -g @cpu_low_fg_color "#{E:#{@thm_green}}"
set -g @cpu_medium_fg_color "#{E:#{@thm_yellow}}"
set -g @cpu_high_fg_color "#{E:#{@thm_red}}"
set -g @cpu_medium_thresh "80"
set -g @cpu_high_thresh "90"

# Configure Mem
set -g @ram_percentage_format "%03d%%"
set -g @ram_low_fg_color "#{E:#{@thm_green}}"
set -g @ram_medium_fg_color "#{E:#{@thm_yellow}}"
set -g @ram_high_fg_color "#{E:#{@thm_red}}"
set -g @ram_medium_thresh "80"
set -g @ram_high_thresh "90"
 
# Configure Catppuccin
set -g @catppuccin_flavor "macchiato"
set -g @catppuccin_pane_border_status "off"
set -g @catppuccin_pane_status_enabled "off"
set -g @catppuccin_status_background "none"

# Style
set -g @custom_status_separator "#[fg=#{@thm_surface_2},bg=default,none]"
set -g @custom_status_inline "#[reverse]▋#[noreverse]"
set -g @custom_text "#[fg=#{@thm_subtext_0}]"

# status left
set -g status-left-length 80
set -ga status-left "#[fg=#{@thm_green}]#{?client_prefix,#[fg=#{@thm_red}]#[bold],} 󱗜 #S "

# status right
set -g status-right-length 160
set -g status-right ""

set -ga status-right "swellshinider "
set -ga status-right "#{E:#{@custom_status_separator}}"
set -ga status-right "#[fg=#{cpu_fg_color}]#{E:#{@custom_status_inline}} 󰍛 #{E:#{@custom_text}}#{cpu_percentage} "
set -ga status-right "#{E:#{@custom_status_separator}}"
set -ga status-right "#[fg=#{ram_fg_color}]#{E:#{@custom_status_inline}} 󰘚 #{E:#{@custom_text}}#{ram_percentage} "

#################
#  Run plugins  #
#################
run '~/.tmux/plugins/tpm/tpm'